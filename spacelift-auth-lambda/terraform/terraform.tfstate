{"version":4,"terraform_version":"1.10.6","serial":4,"lineage":"4ac9df85-ccc9-06c1-5091-7926769eb4cc","outputs":{"api_gateway_invoke_url":{"value":"https://5wpvsa34tf.execute-api.us-east-1.amazonaws.com/prod/auth","type":"string"},"api_gateway_url":{"value":"arn:aws:execute-api:us-east-1:590183862488:5wpvsa34tf/prod/auth","type":"string"},"lambda_function_arn":{"value":"arn:aws:lambda:us-east-1:590183862488:function:spacelift-auth-lambda","type":"string"},"lambda_function_name":{"value":"spacelift-auth-lambda","type":"string"}},"resources":[{"mode":"data","type":"archive_file","name":"lambda_zip","provider":"provider[\"registry.opentofu.org/hashicorp/archive\"]","instances":[{"schema_version":0,"attributes":{"exclude_symlink_directories":null,"excludes":null,"id":"43d066ab54739a455f056f7bc8066bd287509b0c","output_base64sha256":"RxFB9syveuNk9efxnY7gAmJpcnOgFF5ZZSDv7crgCYA=","output_base64sha512":"27TKPHS8SQ2aG71KQKmWfaHLqmFhamDH6e5RA4cSJBL47Q6e9PRZ935pAz5KUadgSevKMDpLUHf7pKH5Tt7COg==","output_file_mode":null,"output_md5":"2ed9adb82dd06af2f940b72b3510d056","output_path":"../deployment.zip","output_sha":"43d066ab54739a455f056f7bc8066bd287509b0c","output_sha256":"471141f6ccaf7ae364f5e7f19d8ee00262697273a0145e596520efedcae00980","output_sha512":"dbb4ca3c74bc490d9a1bbd4a40a9967da1cbaa61616a60c7e9ee510387122412f8ed0e9ef4f459f77e69033e4a51a76049ebca303a4b5077fba4a1f94edec23a","output_size":1869,"source":[],"source_content":null,"source_content_filename":null,"source_dir":"../src","source_file":null,"type":"zip"},"sensitive_attributes":[]}]},{"mode":"managed","type":"aws_api_gateway_deployment","name":"spacelift_auth_deployment","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"canary_settings":[],"created_date":"2025-09-11T19:38:30Z","description":"","execution_arn":"arn:aws:execute-api:us-east-1:590183862488:5wpvsa34tf/","id":"47j8wa","invoke_url":"https://5wpvsa34tf.execute-api.us-east-1.amazonaws.com/","rest_api_id":"5wpvsa34tf","stage_description":null,"stage_name":null,"triggers":{"redeployment":"7a73a44b172faf72964cb413c6e699e3e8db0eb9"},"variables":null},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_integration.auth_integration","aws_api_gateway_integration.auth_options_integration","aws_api_gateway_method.auth_options","aws_api_gateway_method.auth_post","aws_api_gateway_resource.auth_resource","aws_api_gateway_rest_api.spacelift_auth_api","aws_iam_role.lambda_role","aws_lambda_function.spacelift_auth","data.archive_file.lambda_zip"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_integration","name":"auth_integration","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"cache_key_parameters":[],"cache_namespace":"carroi","connection_id":"","connection_type":"INTERNET","content_handling":"","credentials":"","http_method":"POST","id":"agi-5wpvsa34tf-carroi-POST","integration_http_method":"POST","passthrough_behavior":"WHEN_NO_MATCH","request_parameters":{},"request_templates":{},"resource_id":"carroi","rest_api_id":"5wpvsa34tf","timeout_milliseconds":29000,"tls_config":[],"type":"AWS_PROXY","uri":"arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:590183862488:function:spacelift-auth-lambda/invocations"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_method.auth_post","aws_api_gateway_resource.auth_resource","aws_api_gateway_rest_api.spacelift_auth_api","aws_iam_role.lambda_role","aws_lambda_function.spacelift_auth","data.archive_file.lambda_zip"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_integration","name":"auth_options_integration","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"cache_key_parameters":[],"cache_namespace":"carroi","connection_id":"","connection_type":"INTERNET","content_handling":"","credentials":"","http_method":"OPTIONS","id":"agi-5wpvsa34tf-carroi-OPTIONS","integration_http_method":"","passthrough_behavior":"WHEN_NO_MATCH","request_parameters":{},"request_templates":{"application/json":"{\"statusCode\": 200}"},"resource_id":"carroi","rest_api_id":"5wpvsa34tf","timeout_milliseconds":29000,"tls_config":[],"type":"MOCK","uri":""},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_method.auth_options","aws_api_gateway_resource.auth_resource","aws_api_gateway_rest_api.spacelift_auth_api"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_integration_response","name":"auth_options_integration_response","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"content_handling":"","http_method":"OPTIONS","id":"agir-5wpvsa34tf-carroi-OPTIONS-200","resource_id":"carroi","response_parameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,x-spacelift-key-id,x-spacelift-key-secret,x-spacelift-endpoint'","method.response.header.Access-Control-Allow-Methods":"'GET,POST,OPTIONS'","method.response.header.Access-Control-Allow-Origin":"'*'"},"response_templates":{},"rest_api_id":"5wpvsa34tf","selection_pattern":"","status_code":"200"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_integration.auth_options_integration","aws_api_gateway_method.auth_options","aws_api_gateway_resource.auth_resource","aws_api_gateway_rest_api.spacelift_auth_api"]}]},{"mode":"managed","type":"aws_api_gateway_method","name":"auth_options","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"api_key_required":false,"authorization":"NONE","authorization_scopes":[],"authorizer_id":"","http_method":"OPTIONS","id":"agm-5wpvsa34tf-carroi-OPTIONS","operation_name":"","request_models":{},"request_parameters":{},"request_validator_id":"","resource_id":"carroi","rest_api_id":"5wpvsa34tf"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_resource.auth_resource","aws_api_gateway_rest_api.spacelift_auth_api"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_method","name":"auth_post","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"api_key_required":false,"authorization":"NONE","authorization_scopes":[],"authorizer_id":"","http_method":"POST","id":"agm-5wpvsa34tf-carroi-POST","operation_name":"","request_models":{},"request_parameters":{"method.request.header.x-spacelift-endpoint":false,"method.request.header.x-spacelift-key-id":false,"method.request.header.x-spacelift-key-secret":false},"request_validator_id":"","resource_id":"carroi","rest_api_id":"5wpvsa34tf"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_resource.auth_resource","aws_api_gateway_rest_api.spacelift_auth_api"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_method_response","name":"auth_options_response","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"http_method":"OPTIONS","id":"agmr-5wpvsa34tf-carroi-OPTIONS-200","resource_id":"carroi","response_models":{},"response_parameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Allow-Origin":true},"rest_api_id":"5wpvsa34tf","status_code":"200"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_method.auth_options","aws_api_gateway_resource.auth_resource","aws_api_gateway_rest_api.spacelift_auth_api"]}]},{"mode":"managed","type":"aws_api_gateway_method_response","name":"auth_response","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"http_method":"POST","id":"agmr-5wpvsa34tf-carroi-POST-200","resource_id":"carroi","response_models":{},"response_parameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Allow-Origin":true},"rest_api_id":"5wpvsa34tf","status_code":"200"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_method.auth_post","aws_api_gateway_resource.auth_resource","aws_api_gateway_rest_api.spacelift_auth_api"]}]},{"mode":"managed","type":"aws_api_gateway_resource","name":"auth_resource","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"carroi","parent_id":"zysr8xvvxg","path":"/auth","path_part":"auth","rest_api_id":"5wpvsa34tf"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_rest_api.spacelift_auth_api"],"create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_rest_api","name":"spacelift_auth_api","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"api_key_source":"HEADER","arn":"arn:aws:apigateway:us-east-1::/restapis/5wpvsa34tf","binary_media_types":[],"body":null,"created_date":"2025-09-11T19:38:14Z","description":"API for Spacelift authentication token generation","disable_execute_api_endpoint":false,"endpoint_configuration":[{"ip_address_type":"ipv4","types":["REGIONAL"],"vpc_endpoint_ids":[]}],"execution_arn":"arn:aws:execute-api:us-east-1:590183862488:5wpvsa34tf","fail_on_warnings":null,"id":"5wpvsa34tf","minimum_compression_size":"","name":"spacelift-auth-api","parameters":null,"policy":"","put_rest_api_mode":null,"root_resource_id":"zysr8xvvxg","tags":{"Environment":"production","Name":"spacelift-auth-api","Purpose":"spacelift-auth"},"tags_all":{"Environment":"production","Name":"spacelift-auth-api","Purpose":"spacelift-auth"}},"sensitive_attributes":[],"private":"bnVsbA==","create_before_destroy":true}]},{"mode":"managed","type":"aws_api_gateway_stage","name":"spacelift_auth_stage","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"access_log_settings":[],"arn":"arn:aws:apigateway:us-east-1::/restapis/5wpvsa34tf/stages/prod","cache_cluster_enabled":false,"cache_cluster_size":"","canary_settings":[],"client_certificate_id":"","deployment_id":"47j8wa","description":"","documentation_version":"","execution_arn":"arn:aws:execute-api:us-east-1:590183862488:5wpvsa34tf/prod","id":"ags-5wpvsa34tf-prod","invoke_url":"https://5wpvsa34tf.execute-api.us-east-1.amazonaws.com/prod","rest_api_id":"5wpvsa34tf","stage_name":"prod","tags":{},"tags_all":{},"variables":{},"web_acl_arn":"","xray_tracing_enabled":false},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_deployment.spacelift_auth_deployment","aws_api_gateway_integration.auth_integration","aws_api_gateway_integration.auth_options_integration","aws_api_gateway_method.auth_options","aws_api_gateway_method.auth_post","aws_api_gateway_resource.auth_resource","aws_api_gateway_rest_api.spacelift_auth_api","aws_iam_role.lambda_role","aws_lambda_function.spacelift_auth","data.archive_file.lambda_zip"]}]},{"mode":"managed","type":"aws_cloudwatch_log_group","name":"lambda_logs","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:logs:us-east-1:590183862488:log-group:/aws/lambda/spacelift-auth-lambda","id":"/aws/lambda/spacelift-auth-lambda","kms_key_id":"","log_group_class":"STANDARD","name":"/aws/lambda/spacelift-auth-lambda","name_prefix":"","retention_in_days":14,"skip_destroy":false,"tags":{},"tags_all":{}},"sensitive_attributes":[],"private":"bnVsbA=="}]},{"mode":"managed","type":"aws_iam_role","name":"lambda_role","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:iam::590183862488:role/spacelift-auth-lambda-role","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-09-11T19:38:14Z","description":"","force_detach_policies":false,"id":"spacelift-auth-lambda-role","inline_policy":[],"managed_policy_arns":["arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"],"max_session_duration":3600,"name":"spacelift-auth-lambda-role","name_prefix":"","path":"/","permissions_boundary":"","tags":{},"tags_all":{},"unique_id":"AROAYS2NTCDMNWVCALUNB"},"sensitive_attributes":[],"private":"bnVsbA==","create_before_destroy":true}]},{"mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_basic_execution","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"id":"spacelift-auth-lambda-role-20250911193815342600000001","policy_arn":"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole","role":"spacelift-auth-lambda-role"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_iam_role.lambda_role"]}]},{"mode":"managed","type":"aws_lambda_function","name":"spacelift_auth","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"architectures":["x86_64"],"arn":"arn:aws:lambda:us-east-1:590183862488:function:spacelift-auth-lambda","code_sha256":"RxFB9syveuNk9efxnY7gAmJpcnOgFF5ZZSDv7crgCYA=","code_signing_config_arn":"","dead_letter_config":[],"description":"","environment":[{"variables":{"LOG_LEVEL":"INFO"}}],"ephemeral_storage":[{"size":512}],"file_system_config":[],"filename":"../deployment.zip","function_name":"spacelift-auth-lambda","handler":"lambda_function.lambda_handler","id":"spacelift-auth-lambda","image_config":[],"image_uri":"","invoke_arn":"arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:590183862488:function:spacelift-auth-lambda/invocations","kms_key_arn":"","last_modified":"2025-09-11T20:00:24.000+0000","layers":[],"logging_config":[{"application_log_level":"","log_format":"Text","log_group":"/aws/lambda/spacelift-auth-lambda","system_log_level":""}],"memory_size":128,"package_type":"Zip","publish":false,"qualified_arn":"arn:aws:lambda:us-east-1:590183862488:function:spacelift-auth-lambda:$LATEST","qualified_invoke_arn":"arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:590183862488:function:spacelift-auth-lambda:$LATEST/invocations","replace_security_groups_on_destroy":null,"replacement_security_group_ids":null,"reserved_concurrent_executions":-1,"role":"arn:aws:iam::590183862488:role/spacelift-auth-lambda-role","runtime":"python3.11","s3_bucket":null,"s3_key":null,"s3_object_version":null,"signing_job_arn":"","signing_profile_version_arn":"","skip_destroy":false,"snap_start":[],"source_code_hash":"RxFB9syveuNk9efxnY7gAmJpcnOgFF5ZZSDv7crgCYA=","source_code_size":1869,"tags":{"Environment":"production","Name":"spacelift-auth-lambda","Purpose":"spacelift-auth"},"tags_all":{"Environment":"production","Name":"spacelift-auth-lambda","Purpose":"spacelift-auth"},"timeout":30,"timeouts":null,"tracing_config":[{"mode":"PassThrough"}],"version":"$LATEST","vpc_config":[]},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19","dependencies":["aws_iam_role.lambda_role","data.archive_file.lambda_zip"]}]},{"mode":"managed","type":"aws_lambda_permission","name":"api_gateway_invoke","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"action":"lambda:InvokeFunction","event_source_token":null,"function_name":"spacelift-auth-lambda","function_url_auth_type":null,"id":"AllowExecutionFromAPIGateway","principal":"apigateway.amazonaws.com","principal_org_id":null,"qualifier":"","source_account":null,"source_arn":"arn:aws:execute-api:us-east-1:590183862488:5wpvsa34tf/*/*","statement_id":"AllowExecutionFromAPIGateway","statement_id_prefix":""},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["aws_api_gateway_rest_api.spacelift_auth_api","aws_iam_role.lambda_role","aws_lambda_function.spacelift_auth","data.archive_file.lambda_zip"]}]}],"check_results":null}
